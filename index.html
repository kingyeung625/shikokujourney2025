<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2025 å†¬ä¹‹å››åœ‹ â€¢ æ™ºæ…§å°èˆªç‰ˆ (V29)</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --primary: #0f4c81;       /* ç¶“å…¸è— */
            --secondary: #537895;     /* æŸ”å’Œè— */
            --accent: #d35400;        /* æ´»åŠ›æ©˜ */
            --bg: #f0f2f5;            /* æ·ºç°èƒŒæ™¯ */
            --card-bg: rgba(255, 255, 255, 0.95);
            --text-main: #2c3e50;
            --text-light: #7f8c8d;
            --line-color: #cbd5e0;
            --radius: 20px;
            --shadow: 0 8px 30px rgba(0,0,0,0.06);
            --glass: blur(12px) saturate(180%);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--bg);
            color: var(--text-main);
            margin: 0;
            padding-bottom: 140px;
            line-height: 1.6;
            background-image: radial-gradient(#e6e9f0 1px, transparent 1px);
            background-size: 20px 20px;
        }

        /* --- Header & GPS Weather --- */
        header {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: var(--glass);
            -webkit-backdrop-filter: var(--glass);
            padding: 15px 20px;
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .header-inner h1 { margin: 0; font-size: 1.2rem; font-weight: 900; color: var(--primary); letter-spacing: -0.5px; }
        .header-inner p { margin: 2px 0 0; font-size: 0.75rem; color: var(--text-light); font-weight: 500; }

        /* GPS Widget */
        .weather-widget {
            background: linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%);
            color: #fff;
            padding: 6px 12px;
            border-radius: 30px;
            font-size: 0.8rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 4px 10px rgba(142, 197, 252, 0.4);
            cursor: pointer;
            transition: transform 0.2s;
        }
        .weather-widget:active { transform: scale(0.95); }

        /* --- Date Nav --- */
        .date-nav {
            background: rgba(255,255,255,0.95);
            padding: 12px 0;
            overflow-x: auto;
            white-space: nowrap;
            border-bottom: 1px solid #eee;
            position: sticky;
            top: 68px; /* Header height approx */
            z-index: 990;
            scrollbar-width: none; /* Hide scrollbar Firefox */
        }
        .date-nav::-webkit-scrollbar { display: none; } /* Hide scrollbar Chrome */
        
        .date-btn {
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 0 6px;
            padding: 8px 18px;
            border-radius: 16px;
            background: #f8f9fa;
            color: #95a5a6;
            font-size: 0.8rem;
            font-weight: 700;
            border: 1px solid transparent;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 60px;
        }
        .date-btn:first-child { margin-left: 20px; }
        .date-btn:last-child { margin-right: 20px; }
        .date-btn span.day { font-size: 1rem; font-weight: 900; }
        
        .date-btn.active {
            background: var(--primary);
            color: #fff;
            box-shadow: 0 6px 15px rgba(15, 76, 129, 0.3);
            transform: translateY(-2px);
        }

        /* --- Timeline Layout --- */
        .container { max-width: 800px; margin: 0 auto; padding: 20px 15px; }
        .timeline-row { display: flex; position: relative; padding-bottom: 25px;}

        /* Time Column */
        .time-col {
            flex: 0 0 70px;
            text-align: right;
            padding-right: 15px;
            padding-top: 5px;
        }
        .start-time { font-size: 1.1rem; font-weight: 900; color: var(--text-main); line-height: 1; letter-spacing: -0.5px; }
        .end-time { font-size: 0.75rem; color: #b2bec3; display: block; margin-top: 4px; }
        .duration-pill {
            display: inline-block; font-size: 0.6rem; color: #fff;
            background: #cbd5e0; padding: 2px 6px; border-radius: 4px;
            margin-top: 4px; font-weight: 600;
        }

        /* Line Column */
        .line-col {
            flex: 0 0 24px;
            position: relative;
            display: flex;
            justify-content: center;
        }
        .line-col::before {
            content: ''; position: absolute; top: 15px; bottom: -15px;
            width: 2px; background: repeating-linear-gradient(to bottom, var(--line-color) 0, var(--line-color) 6px, transparent 6px, transparent 10px); z-index: 0;
        }
        .timeline-row:last-child .line-col::before { display: none; }
        
        .dot {
            width: 16px; height: 16px;
            background: #fff; border: 4px solid var(--primary);
            border-radius: 50%; z-index: 2;
            box-shadow: 0 0 0 3px rgba(255,255,255,1);
            margin-top: 6px;
        }
        
        /* Drive Badge in Line */
        .drive-pill {
            position: absolute; bottom: 10px; left: 14px;
            background: #fff; border: 1px solid var(--line-color);
            color: #636e72; font-size: 0.65rem; padding: 2px 8px;
            border-radius: 12px; z-index: 1; font-weight: bold;
            white-space: nowrap; box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            display: flex; align-items: center; gap: 4px;
        }

        /* Content Column */
        .content-col { flex: 1; min-width: 0; padding-left: 5px; }

        /* Card Design */
        .card {
            background: var(--card-bg);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255,255,255,0.8);
            transition: transform 0.2s;
        }
        .card:active { transform: scale(0.99); }

        /* Visual Header */
        .visual-header {
            height: 140px;
            display: flex; align-items: flex-end; justify-content: space-between;
            position: relative; overflow: hidden;
            background-size: cover; background-position: center;
            padding: 15px;
            color: white;
        }
        .visual-header::after {
            content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(to bottom, rgba(0,0,0,0.1), rgba(0,0,0,0.7)); z-index: 1;
        }
        
        /* Header Elements */
        .header-content { z-index: 2; width: 100%; display: flex; justify-content: space-between; align-items: flex-end; }
        .icon-box { font-size: 2rem; text-shadow: 0 2px 10px rgba(0,0,0,0.3); }
        
        /* Weather Forecast Badge (New Feature) */
        .weather-forecast {
            background: rgba(255,255,255,0.25);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255,255,255,0.4);
            padding: 5px 10px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
            display: flex; flex-direction: column; align-items: flex-end;
            text-shadow: none; color: #fff;
        }
        .weather-temp { font-size: 1.1rem; }

        /* Gradients */
        .grad-nature { background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); } /* Soft Pastel */
        .grad-ocean { background: linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%); }
        .grad-history { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); }
        .grad-food { background: linear-gradient(120deg, #f6d365 0%, #fda085 100%); }
        .grad-shop { background: linear-gradient(to top, #cfd9df 0%, #e2ebf0 100%); }
        .grad-travel { background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); color: #555; }
        .grad-travel .icon-box, .grad-travel .weather-forecast { color: #555; text-shadow: none; border-color: rgba(0,0,0,0.1); }
        .grad-hotel { background: linear-gradient(to top, #30cfd0 0%, #330867 100%); }

        .card-body { padding: 20px; }
        .card-title { font-size: 1.3rem; font-weight: 800; margin: 0 0 10px; color: var(--text-main); line-height: 1.3; }

        .long-desc { 
            font-size: 0.95rem; color: #57606f; text-align: justify; margin-bottom: 20px; 
            line-height: 1.7; font-weight: 400;
        }

        /* Must Boxes */
        .must-row { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 15px; }
        .tag { 
            font-size: 0.75rem; padding: 4px 10px; border-radius: 6px; font-weight: bold; display: inline-flex; align-items: center; gap: 4px; 
        }
        .tag.do { background: #e3f2fd; color: #1565c0; }
        .tag.eat { background: #ffebee; color: #c62828; }
        .tag.know { background: #fff8e1; color: #f57f17; }

        /* Action Bar */
        .action-bar {
            margin-top: 15px; padding-top: 15px; border-top: 1px solid #f1f2f6;
            display: flex; flex-wrap: wrap; gap: 8px; justify-content: space-between; align-items: center;
        }
        
        .btn-group { display: flex; gap: 8px; flex-wrap: wrap; }
        
        .btn-mini {
            border: none; padding: 6px 12px; border-radius: 20px;
            font-size: 0.8rem; cursor: pointer; font-weight: 600;
            display: inline-flex; align-items: center; gap: 5px; text-decoration: none;
            transition: all 0.2s; background: #f1f2f6; color: #57606f;
        }
        .btn-mini:hover { background: #dfe4ea; }
        
        .btn-map { background: #e8f5e9; color: #2e7d32; }
        .btn-book { background: #fff3e0; color: #e67e22; width: 100%; justify-content: center; margin-top: 8px; padding: 10px;}
        .btn-book.booked { background: #27ae60; color: white; }

        /* Mapcode Display */
        .mapcode-box {
            background: #2c3e50; color: #fff; padding: 5px 12px; border-radius: 8px;
            font-family: monospace; font-weight: bold; letter-spacing: 1px; cursor: pointer;
            display: flex; align-items: center; gap: 6px; font-size: 0.9rem;
        }

        /* Toolkit Bar */
        .toolkit-bar {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 400px;
            background: rgba(255,255,255,0.9); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.5);
            padding: 10px 20px; border-radius: 50px;
            display: flex; justify-content: space-between; z-index: 2000;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
        }
        .tool-btn {
            background: none; border: none; cursor: pointer; color: #57606f; 
            font-size: 0.7rem; font-weight: bold; text-align: center;
            display: flex; flex-direction: column; align-items: center;
        }
        .tool-icon { font-size: 1.4rem; margin-bottom: 2px; display: block; transition: transform 0.2s; }
        .tool-btn:active .tool-icon { transform: scale(1.2); }

        /* Modals */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 3000; backdrop-filter: blur(3px); justify-content: center; align-items: flex-end; }
        .modal-content { background: #fff; width: 100%; max-width: 600px; border-radius: 24px 24px 0 0; padding: 30px; padding-bottom: 50px; max-height: 80vh; overflow-y: auto; animation: slideUp 0.3s ease; }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        
        .big-code { font-size: 3rem; font-weight: 900; color: var(--primary); text-align: center; margin: 20px 0; font-family: monospace; word-break: break-all; }
        .close-btn { width: 100%; padding: 12px; background: #f1f2f6; border: none; border-radius: 12px; font-weight: bold; font-size: 1rem; color: #333; }

        /* Helper */
        .hidden { display: none; }
    </style>
</head>
<body>

<header>
    <div class="header-inner">
        <h1>2025 å†¬ä¹‹å››åœ‹</h1>
        <p>12/10 - 12/17 â€¢ è‡ªé§•çµ‚æ¥µç‰ˆ</p>
    </div>
    <div class="weather-widget" onclick="getGPSWeather()" id="gpsWidget">
        <i class="fa-solid fa-location-crosshairs"></i> <span>å®šä½å¤©æ°£</span>
    </div>
</header>

<div class="date-nav" id="nav-tabs"></div>

<div class="container" id="timeline"></div>

<div class="toolkit-bar">
    <button class="tool-btn" onclick="searchNearby('gas_station')"><span class="tool-icon">â›½</span>æ²¹ç«™</button>
    <button class="tool-btn" onclick="searchNearby('parking')"><span class="tool-icon">ğŸ…¿ï¸</span>åœè»Š</button>
    <button class="tool-btn" onclick="searchNearby('convenience_store')"><span class="tool-icon">ğŸª</span>ä¾¿åˆ©åº—</button>
    <button class="tool-btn" onclick="openModal('hotelModal')"><span class="tool-icon">ğŸ¨</span>ä½å®¿</button>
</div>

<div class="modal" id="mapcodeModal" onclick="if(event.target===this) closeModal('mapcodeModal')">
    <div class="modal-content">
        <h3 style="text-align:center; color:#999; margin:0;">è»Šè¼‰å°èˆªè¼¸å…¥</h3>
        <div class="big-code" id="bigMapcodeText"></div>
        <button class="close-btn" onclick="closeModal('mapcodeModal')">é—œé–‰è¦–çª—</button>
    </div>
</div>

<div class="modal" id="hotelModal" onclick="if(event.target===this) closeModal('hotelModal')">
    <div class="modal-content">
        <h2 style="margin-top:0; color:var(--primary)">ä½å®¿åˆ—è¡¨</h2>
        <div id="hotel-list-container"></div>
        <br>
        <button class="close-btn" onclick="closeModal('hotelModal')">é—œé–‰</button>
    </div>
</div>

<script>
    // --- æ“´å……è³‡æ–™çµæ§‹ (åŠ å…¥ lat, lon ä»¥ä¾›å¤©æ°£æŸ¥è©¢) ---
    // è«‹æ³¨æ„ï¼šå·²æ‰‹å‹•è£œä¸Šä¸»è¦æ™¯é»çš„ç¶“ç·¯åº¦
    const itinerary = [
        {
            date: "12/10 (ä¸‰)", shortDate: "12/10", title: "é¦™æ¸¯ â†’ é«˜æ¾", 
            realDate: "2025-12-10", // å¤©æ°£APIç”¨
            events: [
                { time: "06:00", end: "06:25", type: "travel", title: "å‡ºç™¼å‰å¾€é’è¡£", icon: "ğŸ ", gradient: "grad-travel", desc: "é ç´„çš„å£«å¾èƒå¾·èŠ±åœ’å‰å¾€é’è¡£ç«™ã€‚", mustDo: ["è­·ç…§", "é§•ç…§"], lat: 22.36, lon: 114.11 },
                { time: "06:50", end: "09:20", type: "travel", title: "é¦™æ¸¯åœ‹éš›æ©Ÿå ´", icon: "ğŸ›«", gradient: "grad-travel", desc: "HK Express æ«ƒæª¯è¾¦ç†ç™»æ©Ÿï¼Œäº«ç”¨æ—©é¤ã€‚", lat: 22.31, lon: 113.93 },
                { time: "13:45", end: "14:15", type: "travel", title: "æŠµé”é«˜æ¾æ©Ÿå ´", icon: "ğŸŒ", gradient: "grad-travel", desc: "å…¥å¢ƒï¼Œå–è¡Œæã€‚æ­¡è¿ä¾†åˆ°çƒå†¬ç¸£ï¼", lat: 34.21, lon: 134.01 },
                { time: "14:15", end: "14:45", type: "travel", title: "Nissan ç§Ÿè»Š", icon: "ğŸš—", gradient: "grad-travel", desc: "è¾¦ç†ç§Ÿè»Šæ‰‹çºŒï¼Œè¨­å®šå°èˆªï¼Œæª¢æŸ¥ETCã€‚", mapcode: "60 122 646*55", lat: 34.21, lon: 134.02 },
                { time: "15:15", end: "17:00", type: "sight", title: "æ —æ—å…¬åœ’", icon: "ğŸ", gradient: "grad-nature", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/1/10/Ritsurin_Garden05s3200.jpg/800px-Ritsurin_Garden05s3200.jpg", desc: "ç±³å…¶æ—ä¸‰æ˜Ÿåº­åœ’ï¼Œä¸€æ­¥ä¸€æ™¯ã€‚æ¨è–¦ç™»ä¸Šã€Œé£›ä¾†å³°ã€æ‹æ”å…¨æ™¯ã€‚", mustDo: ["é£›ä¾†å³°", "æ¬æœˆäº­"], price: "410å††", mapcode: "60 575 289*76", lat: 34.33, lon: 134.04 },
                { time: "17:30", end: "19:30", type: "shop", title: "é«˜æ¾ä¸­å¤®å•†åº—è¡—", icon: "ğŸ›ï¸", gradient: "grad-shop", desc: "æ—¥æœ¬æœ€é•·æ‹±å»Šå•†åº—è¡—ï¼Œè—¥å¦ã€Loftã€ç„¡å°è‰¯å“æ‡‰æœ‰ç›¡æœ‰ã€‚", mustDo: ["ä¸¸é¾œç”º"], mapcode: "60 635 156*25", lat: 34.34, lon: 134.05 },
                { time: "19:30", end: "21:00", type: "food", title: "ç‡’è‚‰ é«˜æ¾æ–‡å…«", icon: "ğŸ¥©", gradient: "grad-food", desc: "Tabelog ç™¾ååº—ã€‚äº«å—é»‘æ¯›å’Œç‰›èˆ‡åšåˆ‡ç‰›èˆŒã€‚", mustEat: ["å’Œç‰›æ‹¼ç›¤"], mapcode: "087-863-7789", tabelog: "https://tabelog.com/kagawa/A3701/A370101/37000342/", lat: 34.33, lon: 134.05 },
                { time: "21:00", end: "", type: "hotel", title: "é«˜æ¾æ±æ€¥REI", icon: "ğŸ›ï¸", gradient: "grad-hotel", desc: "ä½æ–¼å¸‚ä¸­å¿ƒï¼Œåœè»Šæ–¹ä¾¿ã€‚æ—©é»ä¼‘æ¯ã€‚", mapcode: "087-821-0109", lat: 34.34, lon: 134.05 }
            ]
        },
        {
            date: "12/11 (å››)", shortDate: "12/11", title: "å°è±†å³¶ç’°å³¶",
            realDate: "2025-12-11",
            events: [
                { time: "07:30", end: "08:02", type: "travel", title: "é«˜æ¾æ¸¯ (æ¸¡è¼ª)", icon: "ğŸš¢", gradient: "grad-ocean", desc: "äººè»Šå…±ä¹˜ï¼Œé§›ä¸Š 08:02 çš„å¤§å‹æ¸¡è¼ªå‰å¾€åœŸåº„æ¸¯ã€‚", price: "ç´„6000å††", mapcode: "60 666 064*40", lat: 34.35, lon: 134.05 },
                { time: "09:30", end: "10:30", type: "sight", title: "å¤©ä½¿ä¹‹è·¯", icon: "ğŸ‘¼", gradient: "grad-nature", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/4/41/Angel_Road_Shodoshima_Japan01n.jpg/800px-Angel_Road_Shodoshima_Japan01n.jpg", desc: "é€€æ½®æ™‚æ‰æœƒæµ®ç¾çš„æ²™æ´²ï¼Œæˆ€äººçš„è–åœ°ã€‚", mustDo: ["èµ°éæ²™æ´²"], mapcode: "364 787 869", lat: 34.47, lon: 134.18 },
                { time: "11:00", end: "12:30", type: "food", title: "Evisu (æ‰‹å»¶ç´ éºµ)", icon: "ğŸœ", gradient: "grad-food", desc: "å“åšå°è±†å³¶åç‰©æ‰‹å»¶ç´ éºµï¼Œå£æ„ŸQå½ˆã€‚", mustEat: ["ç´ éºµå®šé£Ÿ"], mapcode: "37004672", lat: 34.47, lon: 134.19 },
                { time: "12:30", end: "13:45", type: "sight", title: "å°è±†å³¶æ©„æ¬–å…¬åœ’", icon: "ğŸ§¹", gradient: "grad-history", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/f/f7/Shodoshima_Olive_Park02s3.jpg/800px-Shodoshima_Olive_Park02s3.jpg", desc: "é­”å¥³å®…æ€¥ä¾¿æ‹æ”åœ°ã€‚å…è²»å€ŸæƒæŠŠåœ¨ç™½è‰²é¢¨è»Šå‰æ‹ç…§ã€‚", mustDo: ["é¨æƒæŠŠ"], mapcode: "364 798 304*14", lat: 34.47, lon: 134.24 },
                { time: "14:30", end: "15:15", type: "sight", title: "ä¸¸é‡‘é†¬æ²¹ç´€å¿µé¤¨", icon: "ğŸ¶", gradient: "grad-history", desc: "å……æ»¿é†¬æ²¹é¦™æ°£çš„è¡—é“ï¼Œå¿…åƒé†¬æ²¹éœœæ·‡æ·‹ã€‚", mustEat: ["é†¬æ²¹å†°æ·‡æ·‹"], mapcode: "364 773 559*82", lat: 34.46, lon: 134.30 },
                { time: "15:45", end: "16:45", type: "sight", title: "å¯’éœæºª", icon: "ğŸš ", gradient: "grad-nature", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/7/70/Kankakei12s5s4200.jpg/800px-Kankakei12s5s4200.jpg", desc: "æ—¥æœ¬ä¸‰å¤§ç¾éº—æºªè°·ï¼Œæ­ä¹˜çºœè»Šä¿¯ç°ç€¨æˆ¶å…§æµ·ã€‚", mustDo: ["æŠ•ç“¦ç‰‡"], mapcode: "758 020 596*70", lat: 34.51, lon: 134.29 },
                { time: "19:00", end: "20:30", type: "food", title: "ç€¬æˆ¸ã®ç¥­å¯¿ã—", icon: "ğŸ£", gradient: "grad-food", desc: "é«˜æ¾å¿…åƒè¿´è½‰å£½å¸ï¼Œæ©„æ¬–æ²¹é¤Šå¤§çš„å“ˆç‘ªå…¶é­šã€‚", mustEat: ["æ©„æ¬–ãƒãƒãƒ"], mapcode: "087-813-2880", lat: 34.34, lon: 134.05 }
            ]
        },
        {
            date: "12/12 (äº”)", shortDate: "12/12", title: "æ·¡è·¯å³¶ & å¾·å³¶",
            realDate: "2025-12-12",
            events: [
                { time: "10:30", end: "12:00", type: "sight", title: "å¤§é³´é–€æ©‹ç´€å¿µé¤¨", icon: "ğŸ§…", gradient: "grad-shop", desc: "æ´‹è”¥ä¸»é¡Œæ¨‚åœ’ï¼Œèˆ‡å·¨å¤§çš„æ´‹è”¥é›•åƒåˆç…§ã€‚", mustDo: ["æŠ“æ´‹è”¥æ©Ÿ"], mapcode: "406 307 164*17", lat: 34.23, lon: 134.64 },
                { time: "12:45", end: "13:45", type: "food", title: "Miele æµ·æ™¯é¤å»³", icon: "ğŸ•", gradient: "grad-food", desc: "æ·¡è·¯å³¶è¥¿æµ·å²¸ç¶²ç¾åº—ï¼Œå»ä»”é­š Pizza å †æˆå±±ã€‚", mustEat: ["Shirasu Pizza"], mapcode: "0799-80-2600", lat: 34.55, lon: 134.90 },
                { time: "15:00", end: "16:15", type: "sight", title: "è–«å¯¿å ‚", icon: "ğŸ•¯ï¸", gradient: "grad-shop", desc: "é«”é©—è£½ä½œå±¬æ–¼è‡ªå·±çš„ç·šé¦™ã€‚", mustDo: ["è£½é¦™é«”é©—"], mapcode: "946 703 354*55", lat: 34.44, lon: 134.86 },
                { time: "16:30", end: "18:00", type: "food", title: "å¹¸ç¦é¬†é¤… (æ·¡è·¯)", icon: "ğŸ¥", gradient: "grad-food", desc: "ååœ¨æµ·é‚Šç›ªé¦éŸ†ï¼Œæ¬£è³çµ•ç¾å¤•é™½èˆ‡åšé¬†é¤…ã€‚", mustEat: ["åšé¬†é¤…"], mapcode: "946 761 578*30", lat: 34.49, lon: 134.87 },
                { time: "19:15", end: "20:00", type: "food", title: "ç‹ç‹è»’ (å¾·å³¶æ‹‰éºµ)", icon: "ğŸœ", gradient: "grad-food", desc: "è¶…æ¿ƒéƒè±šéª¨æ¹¯é ­ï¼ŒåŠ ç”Ÿè›‹èˆ‡ç™½é£¯æ˜¯æ­£å®—åƒæ³•ã€‚", mustEat: ["è‚‰ç‰æ‹‰éºµ"], mapcode: "088-693-0393", lat: 34.12, lon: 134.50 },
                { time: "21:00", end: "", type: "hotel", title: "å¾·å³¶ Smile Hotel", icon: "ğŸ›ï¸", gradient: "grad-hotel", desc: "å…¥ä½ä¼‘æ¯ã€‚", mapcode: "088-626-0889", lat: 34.07, lon: 134.55 }
            ]
        },
        {
            date: "12/13 (å…­)", shortDate: "12/13", title: "é›²é‚Šå¯º & ä»Šæ²»",
            realDate: "2025-12-13",
            events: [
                { time: "12:00", end: "14:00", type: "sight", title: "é›²é‚Šå¯ºå±±é ‚å…¬åœ’", icon: "ğŸš ", gradient: "grad-nature", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/3/37/Unpenji_ropeway_sanroku_station.jpg/800px-Unpenji_ropeway_sanroku_station.jpg", desc: "å¤©ç©ºé¦éŸ†ï¼Œè…³ä¸‹å°±æ˜¯è®šå²å¹³åŸã€‚", mustDo: ["å¤©ç©ºé¦éŸ†"], mapcode: "207 805 305*47", lat: 34.03, lon: 133.72 },
                { time: "15:30", end: "17:00", type: "sight", title: "ä»Šæ²»æ¯›å·¾ç¾è¡“é¤¨", icon: "ğŸ§¸", gradient: "grad-shop", desc: "åš•åš•ç±³çš„ä¸–ç•Œï¼Œè³¼è²·æœ€é«˜ç´šä»Šæ²»æ¯›å·¾ã€‚", mustDo: ["è²·æ¯›å·¾"], mapcode: "119 454 787*28", lat: 33.99, lon: 133.02 },
                { time: "17:30", end: "19:00", type: "food", title: "ç‡’é³¥ Maruya", icon: "ğŸ—", gradient: "grad-food", desc: "ä»Šæ²»åç‰©éµæ¿å£“ç…é›çš®ï¼Œçš®è„†è‚‰å«©ã€‚", mustEat: ["éµæ¿é›çš®"], mapcode: "0898-32-3638", lat: 34.06, lon: 133.00 },
                { time: "20:30", end: "", type: "hotel", title: "Hotel Liberty", icon: "ğŸ›ï¸", gradient: "grad-hotel", desc: "æ¾å±±å¸‚å…§ä½å®¿ï¼Œé™„å¤§æµ´å ´ã€‚", mapcode: "089-968-2526", lat: 33.83, lon: 132.76 }
            ]
        },
        {
            date: "12/14 (æ—¥)", shortDate: "12/14", title: "æ¾å±±æ…¢æ´»",
            realDate: "2025-12-14",
            events: [
                { time: "12:30", end: "13:30", type: "food", title: "é„‰åœŸæ–™ç† äº”å¿—å–œ", icon: "ğŸ±", gradient: "grad-food", desc: "å“åšè‰²å½©ç¹½ç´›çš„äº”è‰²ç´ éºµèˆ‡é¯›é­šé£¯ã€‚", mustEat: ["äº”è‰²ç´ éºµ"], mapcode: "089-933-3838", lat: 33.83, lon: 132.76 },
                { time: "13:30", end: "15:30", type: "sight", title: "æ¾å±±åŸ", icon: "ğŸ°", gradient: "grad-history", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/c/c1/Matsuyama_Castle_Honten.jpg/800px-Matsuyama_Castle_Honten.jpg", desc: "æ­å–®äººåŠæ¤…ä¸Šå±±ï¼Œé¢¨æ™¯çµ•ä½³ã€‚", mustDo: ["ç™»å¤©å®ˆé–£"], mapcode: "089-921-4873", lat: 33.84, lon: 132.76 },
                { time: "16:00", end: "17:30", type: "sight", title: "é«˜å³¶å±‹æ‘©å¤©è¼ª", icon: "ğŸ¡", gradient: "grad-shop", desc: "æ†‘è­·ç…§å¯èƒ½å…è²»æ­ä¹˜ï¼Œä¿¯ç°å¸‚æ™¯ã€‚", mustDo: ["çœ‹å¤œæ™¯"], mapcode: "089-948-2111", lat: 33.83, lon: 132.76 },
                { time: "18:00", end: "19:30", type: "sight", title: "é“å¾Œæº«æ³‰æœ¬é¤¨", icon: "â™¨ï¸", gradient: "grad-history", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/c/c0/Dogo_Onsen_Honkan_front_view.jpg/800px-Dogo_Onsen_Honkan_front_view.jpg", desc: "ç¥éš±å°‘å¥³æ²¹å±‹åŸå‹ï¼Œå¿…æ³¡æ—¥æœ¬æœ€å¤è€æº«æ³‰ã€‚", mustDo: ["ç¥ä¹‹æ¹¯"], mapcode: "53 349 770*81", lat: 33.85, lon: 132.78 },
                { time: "19:30", end: "21:00", type: "food", title: "é“å¾Œéº¦é…’é¤¨", icon: "ğŸº", gradient: "grad-food", desc: "æ³¡æ¹¯å¾Œä¾†ä¸€æ¯é“å¾Œå•¤é…’èˆ‡ç‚¸é­šæ¿ã€‚", mustEat: ["é“å¾Œå•¤é…’"], mapcode: "089-945-6866", lat: 33.85, lon: 132.78 }
            ]
        },
        {
            date: "12/15 (ä¸€)", shortDate: "12/15", title: "æ¾å±± â†’ é«˜æ¾",
            realDate: "2025-12-15",
            events: [
                { time: "12:30", end: "13:15", type: "sight", title: "éŒ¢å½¢ç ‚ç¹ª", icon: "ğŸ’°", gradient: "grad-history", desc: "çœ‹ä¸€çœ¼å°±èƒ½ä¸€ç”Ÿä¸ç¼ºéŒ¢çš„èƒ½é‡æ™¯é»ã€‚", mustDo: ["æ±‚è²¡é‹"], mapcode: "77 159 380*14", lat: 34.13, lon: 133.64 },
                { time: "13:30", end: "14:30", type: "food", title: "é­šéµ (æµ·é®®)", icon: "ğŸ¦", gradient: "grad-food", desc: "è§€éŸ³å¯ºç¬¬ä¸€ååº—ï¼Œä»½é‡é©šäººçš„ç”Ÿé­šç‰‡ã€‚", mustEat: ["åˆºèº«å®šé£Ÿ"], mapcode: "0875-25-9336", lat: 34.12, lon: 133.65 },
                { time: "15:00", end: "16:30", type: "sight", title: "é«˜æ¾åŸè·¡", icon: "ğŸ¯", gradient: "grad-history", desc: "æµ·æ°´è­·åŸæ²³ï¼Œå¯ä»¥é¤µé£Ÿæµ·è£¡çš„é¯›é­šã€‚", mustDo: ["é¤µé¯›é­š"], mapcode: "60 636 585*00", lat: 34.35, lon: 134.05 },
                { time: "16:30", end: "17:30", type: "sight", title: "åŒ—æ¿± Alley", icon: "ğŸ§±", gradient: "grad-shop", desc: "èˆŠå€‰åº«æ”¹å»ºçš„æ–‡é’èšè½ï¼Œçœ‹æµ·å–å’–å•¡ã€‚", mapcode: "60 637 064*12", lat: 34.35, lon: 134.05 },
                { time: "18:30", end: "20:00", type: "food", title: "å¯„é³¥å‘³é³¥", icon: "ğŸ—", gradient: "grad-food", desc: "é«˜æ¾åœ¨åœ°äººæ›´æ„›çš„éª¨ä»˜é³¥ï¼Œå£å‘³è¼ƒæº«å’Œã€‚", mustEat: ["éª¨ä»˜é³¥"], mapcode: "087-822-8247", lat: 34.34, lon: 134.05 },
                { time: "21:30", end: "", type: "hotel", title: "æœ›æµ·èŠé…’åº—", icon: "ğŸ›ï¸", gradient: "grad-hotel", desc: "æµ·æ™¯æˆ¿ï¼Œè½æµ·æµªè²å…¥ç¡ã€‚", mapcode: "087-841-9111", lat: 34.35, lon: 134.06 }
            ]
        },
        {
            date: "12/16 (äºŒ)", shortDate: "12/16", title: "é«˜æ¾ç¾é£Ÿ",
            realDate: "2025-12-16",
            events: [
                { time: "11:00", end: "12:00", type: "food", title: "ç«¹æ¸…æœ¬åº—", icon: "ğŸ¥š", gradient: "grad-food", desc: "åŠç†Ÿè›‹å¤©å©¦ç¾…å‰µå§‹åº—ï¼Œè‡ªåŠ©å¼çƒå†¬æ¨‚è¶£å¤šã€‚", mustEat: ["åŠç†Ÿè›‹å¤©"], mapcode: "087-834-7296", lat: 34.33, lon: 134.04 },
                { time: "12:30", end: "20:00", type: "shop", title: "Youme Town é«˜æ¾", icon: "ğŸ¬", gradient: "grad-shop", desc: "æœ€å¾Œè¡åˆºï¼è¶…å¸‚ã€Uniqloã€é›»å™¨ä¸€æ¬¡è²·é½Šã€‚", mustDo: ["è¶…å¸‚æƒè²¨"], mapcode: "60 515 519*33", lat: 34.32, lon: 134.06 },
                { time: "20:00", end: "21:30", type: "food", title: "å‘³è™• Katsura", icon: "ğŸŸ", gradient: "grad-food", desc: "éš±ä¸–å±…é…’å±‹ï¼Œå¿…åƒå‰çš®é­šæ´»é€ ä½é­šè‚ã€‚", mustEat: ["å‰çš®é­š"], mapcode: "087-822-3751", lat: 34.34, lon: 134.05 }
            ]
        },
        {
            date: "12/17 (ä¸‰)", shortDate: "12/17", title: "æ­¸åœ‹",
            realDate: "2025-12-17",
            events: [
                { time: "08:30", end: "09:30", type: "food", title: "æ‰‹æ‰“åæ®µ ç¬¨è›‹ä¸€ä»£", icon: "ğŸ§ˆ", gradient: "grad-food", desc: "å¥¶æ²¹é»‘èƒ¡æ¤’çƒå†¬ï¼Œå‘³é“åƒCarbonaraã€‚", mustEat: ["é‡œå¥¶æ²¹çƒå†¬"], mapcode: "087-862-4705", lat: 34.33, lon: 134.06 },
                { time: "10:30", end: "11:15", type: "travel", title: "Nissan é‚„è»Š", icon: "ğŸš—", gradient: "grad-travel", desc: "åŠ æ»¿æ²¹ï¼Œæª¢æŸ¥éºç•™ç‰©ã€‚", mapcode: "60 122 646*55", lat: 34.21, lon: 134.02 },
                { time: "11:30", end: "14:30", type: "travel", title: "é«˜æ¾ç©ºæ¸¯", icon: "âœˆï¸", gradient: "grad-travel", desc: "æœ€å¾Œæ©Ÿæœƒå–é«˜æ¹¯æ°´é¾é ­ï¼Œè²·ä¼´æ‰‹ç¦®ã€‚", mustDo: ["å–é«˜æ¹¯"], lat: 34.21, lon: 134.01 }
            ]
        }
    ];

    const hotels = [
        {name: "é«˜æ¾æ±æ€¥REI", tel: "087-821-0109", note: "é«˜æ¾å¸‚ä¸­å¿ƒ | 12/10-12"},
        {name: "å¾·å³¶ Smile Hotel", tel: "088-626-0889", note: "å¾·å³¶ç«™å‰ | 12/12"},
        {name: "Hotel Liberty", tel: "089-968-2526", note: "æ¾å±±å¤§æµ´å ´ | 12/13-15"},
        {name: "æœ›æµ·èŠé…’åº—", tel: "087-841-9111", note: "é«˜æ¾æµ·æ™¯ | 12/15-17"}
    ];

    let currentDayIdx = 0;

    // --- Core Functions ---

    function init() {
        renderNav();
        renderTimeline();
        renderHotels();
    }

    function renderNav() {
        const nav = document.getElementById('nav-tabs');
        nav.innerHTML = '';
        itinerary.forEach((day, idx) => {
            const btn = document.createElement('div');
            btn.className = `date-btn ${idx === currentDayIdx ? 'active' : ''}`;
            btn.innerHTML = `<span class="day">${day.shortDate.split('/')[1]}</span><span style="font-size:0.6rem">DAY ${idx+1}</span>`;
            btn.onclick = () => {
                currentDayIdx = idx;
                renderNav();
                renderTimeline();
            };
            nav.appendChild(btn);
        });
    }

    function renderTimeline() {
        const container = document.getElementById('timeline');
        container.innerHTML = '';
        const day = itinerary[currentDayIdx];

        day.events.forEach((item, idx) => {
            const savedUrl = localStorage.getItem(`book_v29_${currentDayIdx}_${idx}`);
            const duration = calculateDuration(item.time, item.end);
            
            // æ¨™ç±¤ç”Ÿæˆ
            let tagsHtml = '';
            if(item.mustDo) item.mustDo.forEach(t => tagsHtml += `<span class="tag do">âœ¨ ${t}</span>`);
            if(item.mustEat) item.mustEat.forEach(t => tagsHtml += `<span class="tag eat">ğŸ½ï¸ ${t}</span>`);

            // é ç´„æŒ‰éˆ•ç‹€æ…‹
            let bookBtnHtml = savedUrl 
                ? `<button class="btn-mini btn-book booked" onclick="window.open('${savedUrl}', '_blank')"><i class="fa-solid fa-check"></i> æŸ¥çœ‹é ç´„</button>
                   <button class="btn-mini" onclick="removeBooking(${currentDayIdx}, ${idx})">âŒ</button>`
                : `<button class="btn-mini btn-book" onclick="addBooking(${currentDayIdx}, ${idx})"><i class="fa-regular fa-calendar-check"></i> è¨˜éŒ„é ç´„</button>`;

            // Mapcode
            let mapcodeHtml = (item.mapcode && item.mapcode !== '-') 
                ? `<div class="mapcode-box" onclick="showBigMapcode('${item.mapcode}')"><i class="fa-solid fa-car-side"></i> ${item.mapcode}</div>` : '';

            // Header Background
            let headerStyle = item.img ? `background-image: url('${item.img}');` : '';
            let headerClass = `visual-header ${item.gradient}`;

            // å¤©æ°£ Widget ID (ä¾›ç¨å¾ŒéåŒæ­¥å¡«å……)
            let weatherId = `w-${currentDayIdx}-${idx}`;

            const html = `
                <div class="timeline-row">
                    <div class="time-col">
                        <div class="start-time">${item.time}</div>
                        ${duration ? `<span class="duration-pill">${duration}</span>` : ''}
                        <div class="end-time">${item.end || ''}</div>
                    </div>
                    <div class="line-col">
                        <div class="dot"></div>
                        ${item.drive ? `<div class="drive-pill"><i class="fa-solid fa-car"></i> ${item.drive}</div>` : ''}
                    </div>
                    <div class="content-col">
                        <div class="card">
                            <div class="${headerClass}" style="${headerStyle}">
                                <div class="header-content">
                                    <div class="icon-box">${item.icon}</div>
                                    <div class="weather-forecast" id="${weatherId}" data-lat="${item.lat}" data-lon="${item.lon}" data-date="${day.realDate}">
                                        <i class="fa-solid fa-spinner fa-spin"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="card-body">
                                <h3 class="card-title">${item.title}</h3>
                                <div class="must-row">${tagsHtml}</div>
                                <div class="long-desc">${item.desc}</div>
                                
                                <div class="action-bar">
                                    <div class="btn-group">
                                        <a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(item.title)}" target="_blank" class="btn-mini btn-map"><i class="fa-solid fa-map-location-dot"></i> å°èˆª</a>
                                        ${item.tabelog ? `<a href="${item.tabelog}" target="_blank" class="btn-mini" style="background:#faecc9; color:#945c03">Tabelog</a>` : ''}
                                    </div>
                                    ${mapcodeHtml}
                                    ${bookBtnHtml}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            container.insertAdjacentHTML('beforeend', html);
        });

        // æ¸²æŸ“å®Œæˆå¾Œï¼Œè§¸ç™¼å¤©æ°£æŸ¥è©¢
        fetchItineraryWeather();
    }

    // --- Weather Logic ---
    
    // 1. å–å¾—è¡Œç¨‹å¤©æ°£
    async function fetchItineraryWeather() {
        const widgets = document.querySelectorAll('.weather-forecast');
        
        widgets.forEach(async widget => {
            const lat = widget.dataset.lat;
            const lon = widget.dataset.lon;
            const dateStr = widget.dataset.date;

            // ç°¡å–®æª¢æŸ¥ï¼šå¦‚æœæ²’æœ‰ç¶“ç·¯åº¦ (ä¾‹å¦‚å›é¦™æ¸¯å¾Œ)ï¼Œéš±è—
            if(!lat || lat === 'undefined') {
                widget.style.display = 'none';
                return;
            }

            // æ—¥æœŸæª¢æŸ¥ï¼šOpenMeteo åªèƒ½æŸ¥æœªä¾† 14 å¤©
            const tripDate = new Date(dateStr);
            const today = new Date();
            const diffDays = Math.ceil((tripDate - today) / (1000 * 60 * 60 * 24));

            // å¦‚æœæ—¥æœŸå¤ªä¹…é  (>14å¤©)ï¼Œé¡¯ç¤ºå¾…é å ± (æ¨¡æ“¬æ•ˆæœ)
            if (diffDays > 14) {
                widget.innerHTML = `<span style="font-size:0.7rem; opacity:0.8"><i class="fa-solid fa-clock"></i> å¾…é å ±</span>`;
                return; 
            }
            // å¦‚æœæ˜¯éå»çš„æ—¥æœŸ (ä¾‹å¦‚æ¸¬è©¦ç”¨)ï¼Œæˆ–è¿‘æœŸï¼Œå‰‡æŠ“å–è³‡æ–™
            
            try {
                // ä½¿ç”¨ forecast endpoint (å¦‚æœæ˜¯éå»æ—¥æœŸï¼ŒAPIå¯èƒ½æœƒå ±éŒ¯ï¼Œé€™è£¡ç°¡åŒ–è™•ç†ï¼Œå¯¦éš›ä½¿ç”¨æ‡‰åˆ¤æ–·æ­·å²æ•¸æ“š)
                // ç‚ºäº†è®“æ‚¨æ¸¬è©¦çœ‹åˆ°æ•ˆæœï¼Œå¦‚æœæ—¥æœŸéæœŸï¼Œæˆ‘å€‘ä¸é¡¯ç¤ºéŒ¯èª¤ï¼Œè€Œæ˜¯é¡¯ç¤º N/A
                const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&daily=weather_code,temperature_2m_max,temperature_2m_min&timezone=Asia%2FTokyo&start_date=${dateStr}&end_date=${dateStr}`;
                
                const res = await fetch(url);
                const data = await res.json();

                if(data.daily && data.daily.weather_code) {
                    const code = data.daily.weather_code[0];
                    const max = Math.round(data.daily.temperature_2m_max[0]);
                    const min = Math.round(data.daily.temperature_2m_min[0]);
                    const icon = getWeatherIcon(code);
                    
                    widget.innerHTML = `
                        ${icon}
                        <span class="weather-temp">${max}Â° <span style="font-size:0.7em; opacity:0.7">/ ${min}Â°</span></span>
                    `;
                } else {
                    // API å›å‚³ç„¡è³‡æ–™ (å¯èƒ½æ—¥æœŸå¤ªä¹…é )
                    widget.innerHTML = `<span style="font-size:0.7rem"><i class="fa-solid fa-calendar-day"></i> ç„¡è³‡æ–™</span>`;
                }
            } catch (e) {
                console.log("Weather error", e);
                widget.innerHTML = `-`;
            }
        });
    }

    // 2. å–å¾— GPS å³æ™‚å¤©æ°£ (Header)
    function getGPSWeather() {
        const box = document.getElementById('gpsWidget');
        box.innerHTML = `<i class="fa-solid fa-spinner fa-spin"></i> å®šä½ä¸­`;

        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(async (pos) => {
                const lat = pos.coords.latitude;
                const lon = pos.coords.longitude;
                try {
                    const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`);
                    const data = await res.json();
                    const temp = Math.round(data.current_weather.temperature);
                    const code = data.current_weather.weathercode;
                    box.innerHTML = `${getWeatherIcon(code)} ${temp}Â°C (ç•¶å‰)`;
                } catch(e) {
                    box.innerHTML = `âŒ éŒ¯èª¤`;
                }
            }, () => {
                box.innerHTML = `ğŸš« ç„¡æ¬Šé™`;
                alert("è«‹å…è¨±ç€è¦½å™¨å­˜å–ä½ç½®è³‡è¨Š");
            });
        } else {
            alert("æ‚¨çš„è£ç½®ä¸æ”¯æ´å®šä½");
        }
    }

    // WMO Code è½‰æ›åœ–ç¤º
    function getWeatherIcon(code) {
        if(code <= 1) return '<i class="fa-solid fa-sun"></i>';
        if(code <= 3) return '<i class="fa-solid fa-cloud-sun"></i>';
        if(code <= 48) return '<i class="fa-solid fa-smog"></i>';
        if(code <= 67) return '<i class="fa-solid fa-umbrella"></i>';
        if(code <= 77) return '<i class="fa-regular fa-snowflake"></i>';
        if(code <= 99) return '<i class="fa-solid fa-cloud-bolt"></i>';
        return '<i class="fa-solid fa-cloud"></i>';
    }

    // --- Helpers ---
    function calculateDuration(start, end) {
        if (!start || !end) return '';
        const [h1, m1] = start.split(':').map(Number);
        const [h2, m2] = end.split(':').map(Number);
        let diff = (h2 * 60 + m2) - (h1 * 60 + m1);
        if (diff < 0) diff += 24 * 60;
        const h = Math.floor(diff / 60);
        const m = diff % 60;
        return h > 0 ? (m > 0 ? `${h}h${m}m` : `${h}h`) : `${m}m`;
    }

    function addBooking(day, idx) {
        const url = prompt("è«‹è²¼ä¸Šé€£çµ (Google Drive / Dropbox):");
        if(url) {
            localStorage.setItem(`book_v29_${day}_${idx}`, url);
            renderTimeline();
        }
    }
    
    function removeBooking(day, idx) {
        if(confirm("ç¢ºå®šç§»é™¤æ­¤é ç´„ç´€éŒ„ï¼Ÿ")) {
            localStorage.removeItem(`book_v29_${day}_${idx}`);
            renderTimeline();
        }
    }

    function showBigMapcode(code) {
        document.getElementById('bigMapcodeText').innerText = code;
        openModal('mapcodeModal');
    }

    function searchNearby(keyword) {
        window.open(`https://www.google.com/maps/search/?api=1&query=${keyword}`, '_blank');
    }

    function renderHotels() {
        const container = document.getElementById('hotel-list-container');
        let html = '';
        hotels.forEach(h => {
            html += `
                <div style="padding:15px 0; border-bottom:1px solid #eee;">
                    <div style="font-weight:bold; color:#2c3e50; font-size:1.1rem;">${h.name}</div>
                    <div style="color:#7f8c8d; font-size:0.85rem; margin:5px 0;">${h.note}</div>
                    <a href="tel:${h.tel}" style="display:inline-block; background:#e3f2fd; color:#1565c0; padding:5px 10px; border-radius:5px; text-decoration:none; font-weight:bold;">ğŸ“ ${h.tel}</a>
                </div>
            `;
        });
        container.innerHTML = html;
    }

    function openModal(id) { document.getElementById(id).style.display = 'flex'; }
    function closeModal(id) { document.getElementById(id).style.display = 'none'; }

    init();
</script>
</body>
</html>